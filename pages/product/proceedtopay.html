<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title  -->
    <title>Essence - Fashion Ecommerce Template</title>

    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/footer.css">
    <script src="../js/store.js" async></script>
    <script src="../js/feedback.js"></script>
    
    <link rel="icon" href="../img/core-img/favicon.ico">

    <!-- Core Style CSS -->
    <link rel="stylesheet" href="../css/core-style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<style>

.table>tbody>tr>td, .table>tfoot>tr>td{
    vertical-align: middle;
}
@media screen and (max-width: 600px) {
    table#cart tbody td .form-control{
	
		display: inline !important;
	}
	.actions .btn{
		width:36%;
		margin:1.5em 0;
	}
	
	.actions .btn-info{
		float:left;
	}
	.actions .btn-danger{
		float:right;
	}
	
	table#cart thead { display: none; }
	table#cart tbody td { display: block; padding: .6rem; min-width:320px;}
	table#cart tbody tr td:first-child { background: #333; color: #fff; }
	table#cart tbody td:before {
		content: attr(data-th); font-weight: bold;
		display: inline-block; width: 8rem;
	}
	
	
	
	table#cart tfoot td{display:block; }
	table#cart tfoot td .btn{display:block;}
	
}
          </style>
<body onload="showcartitems(),email()">
    <!-- ##### Header Area Start ##### -->
    <header class="header_area" >
      <div class="classy-nav-container breakpoint-off d-flex align-items-center justify-content-between">
          <!-- Classy Menu -->
          <nav class="classy-navbar" id="essenceNav">
              <!-- Logo -->
              <a class="nav-brand"  href="http://localhost:5000/customer.html">Services to Door</a>
              <!-- Navbar Toggler -->
              <div class="classy-navbar-toggler">
                  <span class="navbarToggler"><span></span><span></span><span></span></span>
              </div>
              <!-- Menu -->
              <div class="classy-menu">
                  <!-- close btn -->
                  <div class="classycloseIcon">
                      <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                  </div>
                  <!-- Nav Start -->
                  <div class="classynav">
                      <ul>
                          <li><a href="#">Services</a>
                              <div class="dropdown"> 
                                      <a class="dropdown-item" href="http://localhost:5000/services/customermaid.html">Cleaning</a>
                                      <a class="dropdown-item" href="http://localhost:5000/services/customerelectric.html">Electric</a>
                                      <a class="dropdown-item" href="http://localhost:5000/services/customerkitchen.html">Kitchen Tools</a> 
                              </div>
                          </li>
                          <li><a href="#">Products</a>
                              <ul class="dropdown">
                                  <a class="dropdown-item" href="http://localhost:5000/product/customerutensil.html">Utensils</a>
                                  <a class="dropdown-item" href="http://localhost:5000/product/customerfurniture.html">Furniture</a>
                                  <a class="dropdown-item" href="http://localhost:5000/product/customerbedsheet.html">Bedsheet</a>
                              </ul>
                          </li>
                        
                      </ul>
                  </div>
                  <!-- Nav End -->
              </div>
          </nav>

          <!-- Header Meta Data -->
          <div class="header-meta d-flex clearfix justify-content-end">    
             
              <div class="user-login-info">
                  <a href="http://localhost:3000/logout" id="essenceCartBtn"> <i class="fa fa-sign-out fa-2x" aria-hidden="true"></i></a>
              </div>  
          </div>

      </div>
  </header>
 
    <br>
    <h1>Shopping Cart</h1>
    <hr>
    
      
      <div class="container">
        <table>
          <div id="table">  
          </div>
        	<tfoot>
						
						<tr>
							<td><button class="btn btn-warning"><a href="http://localhost:5000/customer.html"><i class="fa fa-angle-left"></i> Continue Shopping</a> </button></td>
							<!-- <td colspan="2" class="hidden-xs"></td> -->
							<td >
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong class="total" style="font-size:15px;">
                </strong>
              </td>
            
						
            </tr>
          
					</tfoot>
          
        </table>
        
      </div>
      <br>
      <div class="container">
      <table>
          <tr>
            <td colspan="2" class="hidden-xs">
              <button class="btn btn-success" id="order-button1">Get Order Id <i class="fa fa-angle-right"></i> </button>
            </td>
            <td>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <button class="btn btn-success" id="rzp-button1"  disabled>Checkout <i class="fa fa-angle-right"></i> </button>
            </td>
            <td>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="btn btn-success" id="verify-button1" disabled>Verify<i class="fa fa-angle-right"></i> </button>
            </td>
          </tr>
      </table>
      </div>
    
      <!-- <label>Amount    :</label><input type=text id=order-amt /><br/> -->
      <!-- <button id="order-button1">Get Order id from server</button> <br/> -->
      <script>
         var emailid;
      document.getElementById('order-button1').onclick = function(e){
        
        document.getElementById("order-button1").disabled = true;
  document.getElementById("rzp-button1").disabled = false;
        var total=document.getElementsByClassName('total')[0].innerHTML;
         total=total.substring(10)*100;
      var url = 'http://localhost:3000/api/payment/order';
          var params = {
        amount: total,  
        currency: "INR",
        receipt: "su001",
        payment_capture: '1'
      };
      
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.onreadystatechange = function (res) {
          if (xmlHttp.readyState === 4) {
            res=JSON.parse(xmlHttp.responseText);
            document.getElementById('rzp-text').value=res.sub.id;
          }
      }
      xmlHttp.open("POST", url, true); // false for synchronous request
      xmlHttp.setRequestHeader("Content-type", "application/json");
      xmlHttp.send(JSON.stringify(params));
     
      }
      </script>
      
      
      
      
     
      <!-- <label>Order id   :</label> -->
      <input type=hidden id=rzp-text /><br/>
      <!-- <button id="rzp-button1">CHeckout</button> -->
      <div id=paymentDetails></div>
      <input type=hidden id=order-id />
      <br/>
      <input type=hidden id=order-pay-id />
      <br/>
     <input type=hidden id=order-sig />
      <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
      <script>
      document.getElementById('rzp-button1').onclick = function(e){
        document.getElementById("rzp-button1").disabled = true;
  document.getElementById("verify-button1").disabled = false;
          var options = {
          "key": "rzp_test_16QVKCjpkpLblg",  //Enter your razorpay key
          "currency": "INR",
          "name": "Razor Tutorial",
          "description": "Razor Test Transaction",
          "image": "https://previews.123rf.com/images/subhanbaghirov/subhanbaghirov1605/subhanbaghirov160500087/56875269-vector-light-bulb-icon-with-concept-of-idea-brainstorming-idea-illustration-.jpg",
          "order_id": document.getElementById('rzp-text').value,
          "handler": function (response){
              document.getElementById('order-pay-id').value=response.razorpay_payment_id;
       document.getElementById('order-id').value=response.razorpay_order_id;
        document.getElementById('order-sig').value=response.razorpay_signature;
          },
          "theme": {
              "color": "#227254"
          }
      };
          var rzp1 = new Razorpay(options);
          rzp1.open();
          e.preventDefault();
       
      }
      </script>
     
       <!-- <label>Verify Signature</label><button id="verify-button1">Verify</button> -->
      
      <script>
      document.getElementById('verify-button1').onclick = function(e){
        
        alert(emailid);
        document.getElementById("verify-button1").disabled = true;
      var url = 'http://localhost:3000/api/payment/verify';
          var params = {
        razorpay_order_id:  document.getElementById('order-id').value,  
        razorpay_payment_id:  document.getElementById('order-pay-id').value,
        razorpay_signature:  document.getElementById('order-sig').value
      };
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.onreadystatechange = function (res) {
          if (xmlHttp.readyState === 4) {
      alert(xmlHttp.responseText);
          }
      }
      xmlHttp.open("POST", url, true); // false for synchronous request
      xmlHttp.setRequestHeader("Content-type", "application/json");
      xmlHttp.send(JSON.stringify(params));
     // alert("DELETING FROM CART");
      storeDetails();
      
      }
      function storeDetails(){
       // alert("my mail is "+emailid);
       
        fetch("http://localhost:3000/addAllCartDetails", {
                  method:"POST",
                  headers: {
                      'Content-Type': 'application/json',
                  },
                

              })
                  .then((response) => {
                      return response.text();
                  })
                  .then((mytext) => {
                    if (mytext == 'done') {
                             alert("Calling sending email");
                          storeorder()
                                
                        }
                        else {
                                alert(mytext);
                        }
                  })

                  .catch(function () {
                      console.log("error");
                  });
    }

    function storeorder(){
        
        fetch("http://localhost:3000/getpidqty",options)
  .then((response) => {

  return response.json();
  })
  .then((dis) => {
   
  dis.forEach(function (disp) {
     
         
  fetch("http://localhost:3000/sprovider/"+disp.unique,options)
  .then((response) => {
   
  return response.json();
  })
  .then((dis1) => {
  
  dis1.forEach(function (disp1) {
   
      
      var formData = {
    "ProductName":disp1.NameofProd,
    "NameofWorker":disp1.UName,
    "Qty":disp.Qty
   }
      fetch("http://localhost:3000/insertOrder",{  method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
  })
  .then((response) => {

  return response.json();
  })
  .then((mytext) => {
                 
                  })
  .catch(function () {
  console.log("error");
  });
 







  })
  })
  .catch(function () {
  console.log("error");
  });

  
  
  })
  deleteFromCart()
})

  .catch(function () {
  console.log("error");
  });

  return false;
  }





      function deleteFromCart(){
       // alert("my mail is "+emailid);
       
        fetch("http://localhost:3000/deleteAllCart", {
                  method:"POST",
                  headers: {
                      'Content-Type': 'application/json',
                  },
                

              })
                  .then((response) => {
                      return response.text();
                  })
                  .then((mytext) => {
                    if (mytext == 'done') {
                              //  alert("Calling sending email");
                                sendMail(emailid);
                                
                        }
                        else {
                                alert(mytext);
                        }
                  })

                  .catch(function () {
                      console.log("error");
                  });
    }
      function email(){
        fetch("http://localhost:3000/email", options)
                        .then((response) => {
                        return response.json();
                        })
                        .then((respuser) => {
                                
                                respuser.forEach(function (User) {
                                        console.log(User);
                                         console.log("HEKKK"+User.Emailid);
                                       //  alert("returning "+User.Emailid);
                                         emailid=User.Emailid;
                                       
                                })
                       
                        })
                        .catch(function () {
                        console.log("error");
                        });
      }
      function sendMail(mail){
        // alert("my mail is "+mail);
        // alert("o_id"+document.getElementById('order-id').value);
        // alert("p_id"+document.getElementById('order-pay-id').value);
        var total=document.getElementsByClassName('total')[0].innerHTML;
         total=total.substring(10);
       //  alert("total"+total);
      
         var formData = {
                  
                  'oid': document.getElementById('order-id').value,
                  'pid': document.getElementById('order-pay-id').value,
                  'rs': total
                  
              

              }
        fetch("http://localhost:3000/send/"+mail, {
                  
          method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),

              })
                  .then((response) => {
                      return response.text();
                  })
                  .then((mytext) => {
                    if (mytext == 'done') {
                                alert("payment Successful");
                                window.location.href = "/customer";
                        }
                        else {
                                alert(mytext);
                        }
                  })

                  .catch(function () {
                      console.log("error");
                  });
    }
   
      </script>
      
      
      





    <br>
 <br>
 <br>

 <br>
 <br>
 <br>
 <br>

  <br>
 <br>
    <footer style=" bottom:0;">
        <div class="main-content">
          <div class="left box">
            <h2 style="color: white;">About us</h2>
            <div class="content">
                <p>Services is a E-commerce website where user can register for there services or they can use the services which is provided by our website.</p>
            </div>
          </div>
          <div class="center box">
            <h2 style="color: white;">Address</h2>
            <div class="content">
              <div class="place">
                <span class="fas fa-map-marker-alt"></span>
                <span class="text">Nadiad, Gujarat</span>
              </div>
      
              <div class="email">
                  <span class="text">services@example.com</span>
              </div>
            </div>
          </div>
        
          <div class="right box">
            <h2 style="color: white;">FeedBack</h2>
            <div class="content">
            <form action="#">
                <div class="email">
                  <div class="text">Email *</div>
                  <input type="email" required>
                </div>
                <div class="msg">
                  <div class="text">Message *</div>
                  <changeit id=".msgForm" rows="2" cols="25" required></changeit> 
                  <input type="msg" required>
                 <br />
                  <div class="btn">
                    <button type="submit">Send</button>
                  </div>
                <div class="bottom">
                  <center>
                      <span class="credit">Created By Services</a> | </span>
                      <span class="far fa-copyright"></span> 2020 All rights reserved.
                    </center>
                </div>
            </div>
            </form>
          </div>
        </div>
      </div>
      </footer>
    <!-- ##### Footer Area End ##### -->

    <!-- jQuery (Necessary for All JavaScript Plugins) -->
    <script src="../js/jquery/jquery-2.2.4.min.js"></script>
    <!-- Popper js -->
    <script src="../js/popper.min.js"></script>
    <!-- Bootstrap js -->
    <script src="../js/bootstrap.min.js"></script>
    <!-- Plugins js -->
    <script src="../js/plugins.js"></script>
    <!-- Classy Nav js -->
    <script src="../js/classy-nav.min.js"></script>
    <!-- Active js -->
    <script src="../js/active.js"></script>

</body>

<script>
     const options={
     method:"post"
     }
     var counter=0;
     var item=-1;
     const tab=document.getElementById("table");
        function showcartitems(){
            console.log("calling");
            fetch("http://localhost:3000/proceedtopay",options)
            .then((response) => {
           
            return response.json();
            })
            .then((dis) => {
            // alert("out");
            dis.forEach(function (disp) {
           

              var qty=disp.Qty;
              var uni=disp.unique;
              fetch("http://localhost:3000/displayService.html/"+disp.unique,options)
                .then((response) => {
               
                return response.json();
                })
                .then((dis) => {
                  var count=1;
                

                const table=document.createElement('table');
                table.setAttribute("id","cart");
                table.setAttribute('class',"table table-hover table-condensed");
                  
              if(counter==0){
                
                const thead=document.createElement('thead');
                  const tr1=document.createElement('tr');
                        const th=document.createElement('th');
                        th.setAttribute('style',"width:50%");
                        th.innerHTML="Product";
                        
                        const hid=document.createElement('td');
                        hid.setAttribute("colspan","2");
                        hid.setAttribute("class","hidden-xs");

                        const th1=document.createElement('th');
                        th1.setAttribute('style',"width:10%");
                        th1.innerHTML="Price";

                        const th2=document.createElement('th');
                        th2.setAttribute("style","width:8%");
                        th2.innerHTML="Quantity";

                        const th3=document.createElement('th');
                        th3.setAttribute("style","width:10%");

                     
                     
                      tr1.appendChild(th);
                      tr1.appendChild(hid);
                      tr1.appendChild(th1);
                      tr1.appendChild(th2);
                      tr1.appendChild(th3);

                thead.appendChild(tr1);
                table.appendChild(thead);
              
           
                }
                //  alert("OUTER anotehr")
                const thead=document.createElement('thead');
                  const tr1=document.createElement('tr');
                        const th=document.createElement('th');
                        th.setAttribute('style',"width:50%");
                        
                        const hid=document.createElement('td');
                        hid.setAttribute("colspan","2");
                        hid.setAttribute("class","hidden-xs");

                        const th1=document.createElement('th');
                        th1.setAttribute('style',"width:10%");
                       

                        const th2=document.createElement('th');
                        th2.setAttribute("style","width:8%");
                       

                        const th3=document.createElement('th');
                        th3.setAttribute("style","width:10%");

                     
                     
                      tr1.appendChild(th);
                      tr1.appendChild(hid);
                      tr1.appendChild(th1);
                      tr1.appendChild(th2);
                      tr1.appendChild(th3);

                thead.appendChild(tr1);
                table.appendChild(thead);
              
                dis.forEach(function (disp) {
                  counter+=1;
                  // alert("in "+counter);
                 
                 const tbody=document.createElement('tbody');
                  const tr=document.createElement('tr');
                  const Product=document.createElement('td');
                  Product.setAttribute("data-th","Product");
                    const div=document.createElement('div');
                    div.setAttribute("class","row");
                        const div1=document.createElement('div');
                        div1.setAttribute("class","col-sm-4 hidden-xs");
                            const img=document.createElement('img');
                            img.setAttribute('class','img-responsive');
                            img.setAttribute('src',"uploads/"+disp.nameIMG);
                        div1.appendChild(img);
                    div.appendChild(div1);
                        const div2=document.createElement('div');
                        div2.setAttribute('class','col-sm-8');
                            const h4=document.createElement('h4');
                            h4.innerHTML=disp.NameofProd;
                            const p=document.createElement('p');
                            p.innerHTML=disp.descIMG;
                        div2.appendChild(h4);
                        div2.appendChild(p);
                    
                    div.appendChild(div2);

                  Product.appendChild(div);
                  
                  const td1=document.createElement('td');
                  td1.setAttribute("colspan","2");
                  td1.setAttribute('class',"hidden-xs");

                  const td2=document.createElement('td');
                  td2.setAttribute("data-th","Price");
                  td2.setAttribute("class","Price");
                  td2.innerHTML="Rs"+disp.Price;

                  const td3=document.createElement('td');
                  td3.setAttribute("data-th","Quantity");
                  
                      const input=document.createElement('input');
                      input.setAttribute('class','qty form-control text-center Quantity');
                      
                      input.setAttribute('type','number');
                      item=parseInt(item)+1;
                      input.setAttribute('onkeyup',"updateInData('"+disp._id+"?"+item+"')");
                      input.setAttribute("onkeypress","restrictMinus(event)");
                      
                      input.setAttribute('onchange',"updateInData('"+disp._id+"?"+item+"')");
                      input.setAttribute('value',qty);
                      input.setAttribute('min',"1");
                    
                     
                   td3.appendChild(input);

                   const td4=document.createElement('td');
                        td4.setAttribute('class','actions');
                            const button=document.createElement('button');
                            button.setAttribute('class','btn btn-danger btn-sm');
                            const alink11 = document.createElement('a');
                           
                            
                     alink11.setAttribute("href","http://localhost:3000/deleteorder/"+disp._id);
                    
                                const i=document.createElement('i');
                                i.setAttribute('class',"fa fa-trash-o");
                                alink11.appendChild(i);  
                                alink11.setAttribute("color","white");
                                alink11.setAttribute("text-decoration","none");
  
                            button.appendChild(alink11);
                        td4.appendChild(button);

                  tr.appendChild(Product);
                  tr.appendChild(td1);
                  tr.appendChild(td2);
                  tr.appendChild(td3);
                  tr.appendChild(td4);


      tbody.appendChild(tr);
 table.appendChild(tbody);

            
                    // alert("last"+counter);
               
                    tab.appendChild(table);
                
                   
                  update();
                })
                })
                .catch(function () {
                console.log("error");
                });

                
          })
})
.catch(function () {
console.log("error");
});
}
function updateInData(x){
  var que= x.indexOf('?');
  var id=x.substring(0,que);

  var itemnum=x.substring(que+1);
 
  var cartRows=document.getElementsByClassName('table')
 
  var cartRow=cartRows[parseInt(itemnum)]
  var qtyElement=cartRow.getElementsByClassName('Quantity')[0]
                console.log("QTY");
            
  var formData = {
    "Quantity":qtyElement.value
   }
  fetch("http://localhost:3000/updateglobal/"+id,
  {  method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
  })
   
  .then((response) => {
  return response.text();
  })
  .then((mytext) => {
    if (mytext == 'done') {
      update()
                          }
                          else {
                          
                          }
  
  })
  
  .catch(function () {
  console.log("error");
  });
 
}
  </script>
</html>